/* --- RWD 與 App 環境適應 --- */

:root {
    /* 定義安全區域變數，若瀏覽器不支援 env() 則預設為 0px */
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);

    /* 流暢的字體大小縮放 */
    font-size: clamp(14px, 4vw, 16px);
}

.app-container {
    border-radius: 40px;
}

/* --- 頁面佈局的安全區域適應 --- */

.page {
    /* 預設頁面的 padding 適應安全區域 */
    padding-top: calc(2rem + var(--safe-area-inset-top));
    padding-left: calc(1.5rem + var(--safe-area-inset-left));
    padding-right: calc(1.5rem + var(--safe-area-inset-right));
    padding-bottom: var(--safe-area-inset-bottom);
}

.page#map-page, .page#categories-page {
    padding: 0;
}

/* *** 新增/修改：地圖 UI 覆蓋層的安全區域 *** */
.page .map-ui-overlay {
    padding-top: calc(1rem + var(--safe-area-inset-top));
    padding-left: calc(1.5rem + var(--safe-area-inset-left));
    padding-right: calc(1.5rem + var(--safe-area-inset-right));
    padding-bottom: calc(1rem + var(--safe-area-inset-bottom));
}

.page-footer {
    padding-bottom: calc(1.5rem + var(--safe-area-inset-bottom));
}
#categories-page .page-footer#main-footer,
#map-page .page-footer {
    padding-bottom: calc(1rem + var(--safe-area-inset-bottom));
}

#edit-mode-controls .edit-mode-footer {
    padding-bottom: calc(1rem + var(--safe-area-inset-bottom));
}

/* --- 細節/詳情頁 --- */
.details-header .back-btn {
    top: calc(1.5rem + var(--safe-area-inset-top));
    left: calc(1.5rem + var(--safe-area-inset-left));
}
.details-content {
    padding-bottom: calc(2rem + var(--safe-area-inset-bottom));
}

/* --- 元件的安全區域適應 --- */

#map-page .location-search-container {
    top: calc(100px + var(--safe-area-inset-top));
}
#categories-page .location-search-container.in-edit-mode {
    top: calc(40px + var(--safe-area-inset-top));
}

/* 確保篩選面板在安全區域內 */
#filter-panel {
    top: calc(1.5rem + var(--safe-area-inset-top));
}


/* --- Media Queries for smaller devices --- */
@media (max-width: 360px) {
    :root {
        font-size: 13.5px;
    }
    .page, .map-ui-overlay {
        padding-left: 1rem;
        padding-right: 1rem;
    }
    .filter-buttons button {
        padding: 0.4rem 0.8rem;
    }
}

/* 在非行動裝置 (桌面) 環境中，模擬手機外觀 */
@media (min-width: 415px) {
    .app-container {
        height: 80vh;
        max-height: 896px;
        border: 10px solid #1a1a1a;
        box-shadow: 0 10px 50px rgba(0,0,0,0.5);
    }
}