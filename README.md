# 今天吃什麼？ What To Eat Today?

一款旨在解決日常「用餐選擇困難症」的 Web App。透過互動式地圖探索、AI 智慧分類與充滿儀式感的決策工具，提供充滿質感與樂趣的美食探索體驗。

✨ **核心功能 (Features)**
* 📍 **互動式地圖探索**: 定位使用者，並在真實地圖上透過拖曳手把，直觀地「畫」出一個圓形的美食探索半徑。
* 🧠 **AI 智慧分類**: 自動抓取範圍內的所有餐廳，並透過後端 Gemini API 進行智慧分類，現在更能動態產生最貼切的 Emoji 圖示！
* 🌊 **沉浸式探索流程**: 在地圖上無縫瀏覽不同分類的店家列表與資訊，過程無須跳轉頁面，提供不中斷的「心流」體驗。
* 🎡 **充滿儀式感的決策工具**: 將感興趣的店家加入「候選清單」，並透過一個設計精良、動畫流暢的「命運羅盤」做出最終決定。
* 📖 **豐富的店家詳情**: 查看店家的真實照片、使用者評論、完整營業時間、電話、網站等詳細資訊。

---

### **版本演進**

===v1===
* 奠定了專案核心 UI/UX 風格，包含配色、字體與基本版面配置。
* 使用 Mock Data 建立了一個可互動的 App 原型。
* 實現了基本的頁面切換與命運羅盤動畫。

===v2===
* **真實數據串接**: 後端全面改寫，串接 **Google Maps Platform API** 與 **Google Gemini API**，可即時獲取並智慧分類真實世界的餐廳數據。
* **API 金鑰管理**: 引入 `.env` 檔案來管理 API 金鑰，提升安全性。
* **UI/UX 優化**: 升級地圖圖示，並改善探索圈頁面的操作體驗。

===v3===
* **前端架構現代化**: 將原先龐大的 `js/app.js` 檔案，**全面重構為 ES6 模組化架構**，大幅提升程式碼的可維護性與擴展性。
* **更智慧的 AI 分類**: 優化後端 AI Prompt，讓 Gemini API 能自動為美食分類附上最適合的 Emoji。
* **開發流程整合**: Flask 伺服器整合了前端靜態檔案託管，解決了 CORS 問題，實現 `python app.py` 一鍵啟動。
* **API 穩定性修正**: 修正了 Google Maps Place API 的 `fields` 參數錯誤。

===v4===
* **強大的複合式搜尋**: 後端採用**寬泛類型** + **精準關鍵字**的複合式搜尋策略，並結合分頁處理，能最大化地搜尋到區域內所有相關的美食店家，大幅減少遺漏。
* **整合式篩選功能**:
    * 在美食地圖頁新增了設計精美的**篩選面板**，可依「目前營業中」、「價位」、「評分」進行多重條件篩選。
    * 篩選面板具有流暢的滑出動畫，並可透過關閉按鈕或點擊面板外區域來關閉，提供卓越的使用者體驗。
* **多行類別佈局**:
    * 優化了美食分類區的顯示方式，改為**兩行或三行的橫向滾動佈局**，既解決了分類過多時的瀏覽問題，也避免了遮擋地圖視野。
* **使用者體驗優化**:
    * 大幅提升了「探索圈」頁面拖曳手把的靈敏度。
    * 美化了「回到中心」按鈕的 UI 設計，使其更符合整體風格。

===v5===
* **後端架構升級**:
    * **API 拆分**: 將單一搜尋 API 重構為 `/api/find_places` (搜尋店家) 和 `/api/categorize_places` (AI分類) 兩個獨立端點，讓前端可以顯示更詳細的載入進度，優化等待體驗。
    * **Flask Blueprint**: 引入 Blueprint 機制來組織 API 路由，徹底解決了 API `POST` 請求與前端靜態檔案服務的潛在衝突，提升後端穩定性。
* **前端互動革新 - 單擊聚焦**:
    * 簡化了美食地圖頁的核心互動，移除了複雜的雙擊、隱藏/恢復邏輯。
    * 現在**只需單擊**即可多選或取消類別，實現**即時的地圖篩選與下方按鈕的透明度變化**。
    * 當有類別被選中時，最後一個被點擊的類別會觸發**下方店家預覽**與**地圖標記高亮**，互動更直觀。
* **UI/UX 精緻化**:
    * 新增「**重設檢視**」按鈕，僅在使用者篩選類別時出現，方便一鍵恢復初始狀態。
    * 重新佈局了頁面標頭，將操作按鈕群組化，使整體視覺更平衡、更有條理。

---

🚀 **技術棧 (Tech Stack)**
* **前端 (Frontend)**:
    * HTML5 / CSS3 (Flexbox, Grid, Keyframe Animations)
    * JavaScript (ES6+, **模組化 (Modules)**, 無框架)
    * Leaflet.js (開源地圖函式庫)
* **後端 (Backend)**:
    * Python 3 / Flask
    * **Google Maps Platform API**: 用於地理定位與餐廳資料搜尋。
    * **Google Gemini API**: 用於餐廳智慧分類與 Emoji 生成。
    * `python-dotenv`: 用於管理環境變數。

🔧 **如何運行 (Getting Started)**

1.  **Clone Repo**
    ```bash
    git clone [https://github.com/YOUR_USERNAME/what-to-eat.git](https://github.com/YOUR_USERNAME/what-to-eat.git)
    cd what-to-eat
    ```

2.  **取得 API 金鑰**
    * 前往 [Google Cloud Console](https://console.cloud.google.com/) 申請 API 金鑰，並啟用 `Places API`。
    * 前往 [Google AI Studio](https://aistudio.google.com/) 取得 Gemini API 金鑰。

3.  **設定環境變數**
    * 在專案根目錄下，建立一個名為 `.env` 的檔案，並填入您的金鑰：
        ```
        GOOGLE_MAPS_API_KEY="你的Google地圖API金鑰"
        GEMINI_API_KEY="你的Gemini API金鑰"
        ```

4.  **安裝與啟動伺服器**
    ```bash
    # 安裝所需的 Python 套件
    pip install -r requirements.txt

    # 啟動整合後的前後端伺服器
    python app.py
    ```

5.  **開啟 App**
    * 伺服器將會運行在 `http://127.0.0.1:5000`。
    * 請打開您的網頁瀏覽器 (建議使用 Chrome)，並直接訪問 **`http://127.0.0.1:5000`**。
    * **注意**：由於已改為模組化架構，請**不要**再直接點開 `index.html` 檔案，否則會因 CORS 策略而無法運行。